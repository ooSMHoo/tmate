<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mypage">
<!--  
	<update id="updateMypage1" parameterType="com.sp.trip.mypage.Mypage">
		UPDATE member1 SET memberPwd=#{memberPwd} ,membermod_date=SYSDATE,
				memberEmail=#{memberEmail}
		WHERE memberId=#{memberId}
    </update>
    
    <update id="updateMypage2" parameterType="com.sp.trip.mypage.Mypage">
		UPDATE member2 SET memberBirth=#{memberBirth}, memberPhone=#{memberPhone}
		WHERE memberId=#{memberId}
    </update>
-->
    <update id="updateMypage3" parameterType="map">
		UPDATE member1 SET ${colName}=#{colValue}, membermod_date=SYSDATE
		WHERE memberId=#{memberId}
    </update>
    
    <update id="updateMypage4" parameterType="map">
		UPDATE member2 SET ${colName}=#{colValue}
		WHERE memberId=#{memberId}
    </update>

            
   <select id="readMypage" parameterType="String" resultType="com.sp.trip.mypage.Mypage">
	    SELECT m.memberId, memberName, memberPwd, enabled,
	    TO_CHAR(memberBirth, 'YYYY-MM-DD') memberBirth, 
	    memberEmail, memberPhone
	    FROM member1 m
	    LEFT OUTER JOIN member2 m1 ON m.memberId = m1.memberId 
	    WHERE m.memberId = #{memberId}
    </select>
    
    <!-- 찜 리스트 -->
    <select id="listLike" parameterType="map" resultType="com.sp.trip.mypage.LikeList">
		SELECT * FROM (
			SELECT ROWNUM rnum, tb.* FROM (
				SELECT lodgName, mhAddr1, li.memberId, revGrade, li.roomNum, roomName, rphotoName
					FROM likeList li
						JOIN room rm ON rm.roomNum = li.roomNum
						JOIN lodging lo ON rm.mhId = lo.mhId
						JOIN review rv ON li.memberId = rv.memberId
						JOIN memberHost mh ON rm.mhId = mh.mhId
						JOIN lodgingPhoto lp ON rm.mhId = lp.mhId
						WHERE li.memberId = #{memberId} AND ROWNUM =1
			) tb WHERE ROWNUM &lt;= #{end}
		) WHERE rnum &gt;= #{start}
    </select>

	<delete id="deleteLike" parameterType="map" >
		DELETE FROM likeList  
		WHERE roomNum = #{roomNum} AND memberId = #{memberId}
	</delete>
    
    
</mapper>